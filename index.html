<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–õ–µ—â–µ–±—Ä–æ—Å Multiplayer</title>
<style>
body { font-family: Arial; background: linear-gradient(135deg,#8e2de2,#4a00e0); color: white; text-align: center; padding: 20px; }
h1 { font-size: 3em; text-shadow: 2px 2px 5px #000; }
.characters { display:flex; justify-content:center; gap:30px; margin-bottom:20px; }
.character-box { text-align:center; position: relative; }
.character-box img { width:150px; height:150px; object-fit:cover; border-radius:15px; border:3px solid transparent; cursor:pointer; }
input.name-input { margin-bottom:5px; padding:5px; border-radius:5px; border:none; text-align:center; }
button { padding:15px 30px; font-size:18px; border:none; border-radius:15px; cursor:pointer; background:yellow; color:black; font-weight:bold; box-shadow:0 5px 15px rgba(0,0,0,0.3); }
#chat { max-width:600px; margin:20px auto; background:rgba(255,255,255,0.9); color:black; border-radius:15px; padding:15px; height:250px; overflow-y:auto; box-shadow:0 5px 20px rgba(0,0,0,0.5); }
.hand { position:absolute; width:100px; transform:translate(-50%,-50%) rotate(-45deg); display:none; z-index:10; }
.flash { 
  position:absolute; 
  width:150px; height:150px; 
  border-radius:50%; 
  background: radial-gradient(circle, rgba(255,255,0,0.8) 0%, rgba(255,0,255,0) 70%); 
  display:none; z-index:20;
}
</style>
</head>
<body>

<h1>–õ–µ—â–µ–±—Ä–æ—Å Multiplayer</h1>

<div class="characters">
  <div class="character-box">
    <input class="name-input" id="leftName" placeholder="–ò–º—è –õ–µ–≤–æ–≥–æ">
    <input type="file" id="leftUpload"><br>
    <img id="leftImg" src="" alt="–í—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ">
    <div id="leftScore">–û—á–∫–∏: 0</div>
  </div>
  <div class="character-box">
    <input class="name-input" id="rightName" placeholder="–ò–º—è –ü—Ä–∞–≤–æ–≥–æ">
    <input type="file" id="rightUpload"><br>
    <img id="rightImg" src="" alt="–í—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ">
    <div id="rightScore">–û—á–∫–∏: 0</div>
  </div>
</div>

<button id="slapBtn">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —É–¥–∞—Ä–∏—Ç—å!</button>
<div id="chat"></div>
<img id="handImg" src="hand.png" class="hand"/>
<div id="flash" class="flash"></div>
<audio id="slapSound" src="slap2.mp3"></audio>

<script>
const leftImg=document.getElementById('leftImg');
const rightImg=document.getElementById('rightImg');
const leftUpload=document.getElementById('leftUpload');
const rightUpload=document.getElementById('rightUpload');
const leftNameInput=document.getElementById('leftName');
const rightNameInput=document.getElementById('rightName');
const slapBtn=document.getElementById('slapBtn');
const chat=document.getElementById('chat');
const handImg=document.getElementById('handImg');
const slapSound=document.getElementById('slapSound');
const leftScoreDisplay=document.getElementById('leftScore');
const rightScoreDisplay=document.getElementById('rightScore');
const flash=document.getElementById('flash');

let leftScore=0,rightScore=0;
let consecutiveLeft=0,consecutiveRight=0;

const zoomerPhrases=["—â–æ–≤–µ–ª—å","–ø–∏–∫–º–∏","–∞–±–∞—é–¥–Ω–æ","—Ç—É–Ω–≥ —Ç—É–Ω–≥ —Å–∞—Ö—É—Ä","–æ–π –æ–π —Ö–∞–ª–µ–ø–∞","–∫–∏—Å–∏ –∫–∏—Å–∏ –º—è—É –º—è—É","–≤–æ–≥–ª–æ–¥","—Ñ–ª–µ–∫—Å","—á–∏–ª—å","—Ç–æ–ø—á–∏–∫","–ª–æ–ª","—Å–∞–π","–∫—Ä–∞—à","–¥—Ä–æ–ø","—á–µ–ª","–∑–∞—à–∫–≤–∞—Ä"];
const normalPhrases=["—Ç—ã —á–æ –µ–±–ª–∞–Ω?","—Ç—ã –≤–∞—â–µ –µ–±–∞–Ω—É–ª—Å—è?","–Ω–∞ –Ω–∞—Ö—É–π?","–ª—Å–Ω—ã–π –º—É—Å–æ—Ä","—É–±–ª—é–¥–æ–∫ —Å–ª–∞–±—ã–π","–∏–¥–∏ –Ω–∞—Ö—É–π","–¥–µ–±–∏–ª","—Å–ª–∞–±–∞–∫","–ø–æ—à–µ–ª –≤–æ–Ω"];

leftUpload.addEventListener('change',e=>{leftImg.src=URL.createObjectURL(e.target.files[0]);});
rightUpload.addEventListener('change',e=>{rightImg.src=URL.createObjectURL(e.target.files[0]);});

slapBtn.addEventListener('click',()=>{
  if(!leftImg.src || !rightImg.src) return alert("–í—ã–±–µ—Ä–∏ –æ–±–µ —Ñ–æ—Ç–∫–∏!");
  
  slapSound.currentTime=0; slapSound.play();
  
  const leftRect=leftImg.getBoundingClientRect();
  const rightRect=rightImg.getBoundingClientRect();
  const leftTop=leftRect.top+leftRect.height/2;
  const rightTop=rightRect.top+rightRect.height/2;

  let isLeft=Math.random()>0.5;
  let startX,endX,topY,phrase,isFatality=false;

  if(isLeft){
    startX=leftRect.right+leftRect.width*0.1;
    endX=rightRect.left;
    topY=leftTop;
    leftScore++; consecutiveLeft++; consecutiveRight=0;
    phrase=`${leftNameInput.value||"–õ–µ–≤—ã–π"}: ${zoomerPhrases[Math.floor(Math.random()*zoomerPhrases.length)]}`;
    if(consecutiveLeft>=3){ 
      isFatality=true;
      phrase=`${leftNameInput.value||"–õ–µ–≤—ã–π"} —Å–æ–≤–µ—Ä—à–∞–µ—Ç –§–ê–¢–ê–õ–ò–¢–ò! üí•üíÄ`; 
      leftScore+=5; 
      consecutiveLeft=0;
    }
  } else {
    startX=rightRect.left;
    endX=leftRect.right+leftRect.width*0.1;
    topY=rightTop;
    rightScore++; consecutiveRight++; consecutiveLeft=0;
    phrase=`${rightNameInput.value||"–ü—Ä–∞–≤—ã–π"}: ${normalPhrases[Math.floor(Math.random()*normalPhrases.length)]}`;
    if(consecutiveRight>=3){
      isFatality=true;
      phrase=`${rightNameInput.value||"–ü—Ä–∞–≤—ã–π"} —Å–æ–≤–µ—Ä—à–∞–µ—Ç –§–ê–¢–ê–õ–ò–¢–ò! üí•üíÄ`; 
      rightScore+=5;
      consecutiveRight=0;
    }
  }

  chat.innerHTML+=`<p>${phrase}</p>`; chat.scrollTop=chat.scrollHeight;
  leftScoreDisplay.textContent=`–û—á–∫–∏: ${leftScore}`;
  rightScoreDisplay.textContent=`–û—á–∫–∏: ${rightScore}`;

  handImg.style.top=topY+"px";
  handImg.style.left=startX+"px";
  handImg.style.display="block";

  // –ê–Ω–∏–º–∞—Ü–∏—è —Ä—É–∫–∏
  handImg.animate([
    { transform:"translate(0,-50%) rotate(-45deg) scale(0)" },
    { transform:`translate(${endX-startX}px,-50%) rotate(-45deg) scale(1.2)` },
    { transform:`translate(${endX-startX}px,-50%) rotate(-45deg) scale(1)` }
  ],{duration:400,fill:"forwards"});

  // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏ –ø—Ä–∏ —Ñ–∞—Ç–∞–ª–∏—Ç–∏
  if(isFatality){
    flash.style.top=topY-75+"px";
    flash.style.left=endX-75+"px";
    flash.style.display="block";
    flash.style.opacity=1;
    flash.animate([
      { transform:"scale(0.5)", opacity:1 },
      { transform:"scale(1.5)", opacity:0 }
    ], { duration:600, fill:"forwards" });
    setTimeout(()=>{flash.style.display="none";},600);
  }

});
</script>

</body>
</html>
